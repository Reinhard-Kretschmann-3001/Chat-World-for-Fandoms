<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AU List | My AUS Wiki</title>
    <link rel="stylesheet" href="style.css">
    <style>
        /* CSS nội bộ aus.html giữ nguyên */
        .au-item { background-color: #2C3A47; border: 1px solid #7A287E; padding: 15px 20px; margin-bottom: 15px; border-radius: 5px; overflow: hidden; }
        .au-item h3 { color: #E6244C; margin-top: 0; border-bottom: 1px dashed #574B90; padding-bottom: 8px; margin-right: 70px; /* Chỗ cho nút Delete */ }
        .au-item strong { color: #A4B0BE; }
        .delete-btn { background-color: #8B0000; color: #F0F0F0; border: 1px solid #E6244C; padding: 4px 10px; font-size: 0.85em; border-radius: 4px; cursor: pointer; float: right; transition: background-color 0.2s; }
        .delete-btn:hover { background-color: #E6244C; }
        .delete-btn:disabled { background-color: #555; cursor: not-allowed;}
        .loading-msg, .empty-msg { text-align: center; color: #A4B0BE; margin-top: 20px;}
    </style>
</head>
<body>
    <header><h1>Dusttale</h1></header>
    <nav>
        <ul>
            <li><a href="index.html">Home</a></li>
            <li><a href="aus.html" class="active">AU List</a></li>
            <li><a href="create-aus.html">Create AU</a></li>
            <li><a href="characters.html">Characters</a></li>
            <li><a href="contribute.html">Contribute</a></li>
             </ul>
    </nav>
    <main id="au-list-container">
        <h2>AU List</h2>
        <p class="loading-msg">Loading list from server...</p>
    </main>
    <footer>
        <p>&copy; 2025 Dust!Sans [Elliot Davidson]. All rights reserved.</p>
        <p>Website developed based on...</p>
    </footer>

    <script>
        // --- Mã JavaScript Chung (Copy từ index.html) ---
        function getCurrentUser() { /*...*/ return localStorage.getItem('currentUser'); }
        function logoutUser() { /*...*/ localStorage.removeItem('currentUser'); localStorage.removeItem('token'); window.location.reload(); }
        function updateNavBar() { /*...*/ 
             const user = getCurrentUser(); const navUl = document.querySelector('nav ul');
             const authItems = navUl.querySelectorAll('.auth-item'); authItems.forEach(item => item.remove());
             if (user) {
                 const userDropdown = document.createElement('li'); userDropdown.className = 'auth-item dropdown';
                 const userNameLink = document.createElement('a'); userNameLink.href = "#"; userNameLink.textContent = user;
                 userNameLink.onclick = function(event) { event.preventDefault(); toggleUserMenu(); };
                 userDropdown.appendChild(userNameLink);
                 const dropdownContent = document.createElement('ul'); dropdownContent.className = 'dropdown-content'; dropdownContent.id = 'user-menu-content';
                 const logoutItem = document.createElement('li'); logoutItem.innerHTML = `<a href="#" onclick="logoutUser()">Logout</a>`; dropdownContent.appendChild(logoutItem);
                 userDropdown.appendChild(dropdownContent); navUl.appendChild(userDropdown);
             } else {
                 const loginItem = document.createElement('li'); loginItem.className = 'auth-item';
                 loginItem.innerHTML = `<li><a href="auth.html">Login / Register</a></li>`; navUl.appendChild(loginItem);
             }
         }
        function toggleUserMenu() { /*...*/ const menuContent = document.getElementById('user-menu-content'); if (menuContent) { menuContent.classList.toggle('show'); } }
        window.onclick = function(event) { /*...*/ if (!event.target.matches('.dropdown > a')) { const dropdowns = document.getElementsByClassName("dropdown-content"); for (let i = 0; i < dropdowns.length; i++) { if (dropdowns[i].classList.contains('show')) { dropdowns[i].classList.remove('show'); } } } }
        window.logoutUser = logoutUser;

        // --- JavaScript riêng của aus.html ---
        const BACKEND_URL_AUS = 'https://dust-aus-backend.onrender.com/aus';

        window.addEventListener('DOMContentLoaded', () => {
            loadAUs();
            setupDeleteListener();
            updateNavBar(); // Gọi updateNavBar
        });

        async function loadAUs() {
            const main = document.getElementById('au-list-container');
            try {
                const response = await fetch(BACKEND_URL_AUS);
                if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
                const aus = await response.json();
                main.innerHTML = '<h2>AU List</h2>'; // Reset

                if (aus.length === 0) {
                     main.innerHTML += '<p class="empty-msg">No AUs submitted yet. <a href="create-aus.html">Be the first!</a></p>';
                } else {
                    const currentUser = getCurrentUser(); // Lấy user hiện tại
                    const currentToke
